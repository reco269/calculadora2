<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Calculadora PRO â€“ ImpressÃ£o 3D</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<div class="wrap">
  <div class="card">

    <header class="main-header">
      <h1>ğŸ–¨ï¸ Calculadora PRO â€“ ImpressÃ£o 3D</h1>
      <p class="subtitle">VersÃ£o Completa com todos os recursos</p>
    </header>

    <!-- TABS PRINCIPAIS -->
    <div class="tabs-principal">
      <button class="tab-btn active" data-tab="calculadora">ğŸ“Š Calculadora</button>
      <button class="tab-btn" data-tab="historico">ğŸ“œ HistÃ³rico</button>
      <button class="tab-btn" data-tab="comparacao">âš–ï¸ Comparar</button>
      <button class="tab-btn" data-tab="cliente">ğŸ’¼ Modo Cliente</button>
    </div>

    <!-- ========== ABA: CALCULADORA ========== -->
    <div class="tab-content active" data-content="calculadora">

      <!-- Templates RÃ¡pidos -->
      <div class="templates-section">
        <strong>âš¡ Templates RÃ¡pidos:</strong>
        <div class="templates-grid">
          <button class="template-btn" data-template="miniatura">ğŸ­ Miniatura</button>
          <button class="template-btn" data-template="funcional">ğŸ  Funcional</button>
          <button class="template-btn" data-template="presente">ğŸ Presente</button>
          <button class="template-btn" data-template="industrial">ğŸ”§ Industrial</button>
        </div>
      </div>

      <!-- Modo de CÃ¡lculo -->
      <div class="mode">
        <button id="btnBasico" class="btn active" type="button">Modo BÃ¡sico</button>
        <button id="btnAvancado" class="btn" type="button">Modo AvanÃ§ado</button>
      </div>

      <form id="calcForm" class="grid" novalidate>

        <!-- BÃSICO -->
        <div class="field">
          <label for="peso">Filamento usado (g)</label>
          <input id="peso" type="number" min="0" step="0.1" value="80" required>
        </div>

        <div class="field">
          <label for="precoKg">PreÃ§o do filamento (R$/kg)</label>
          <input id="precoKg" type="number" min="0" step="0.01" value="120" required>
        </div>

        <div class="field">
          <label for="margem">Margem (%)</label>
          <input id="margem" type="number" min="0" max="100" step="0.1" value="40" required>
          <div id="alertaMargem" class="alerta" style="display:none;"></div>
        </div>

        <!-- AVANÃ‡ADO -->
        <div id="advanced" class="advanced">

          <div class="field">
            <label for="tempoHoras">Tempo de impressÃ£o</label>
            <div class="time-row">
              <select id="tempoHoras"></select>
              <select id="tempoMinutos"></select>
            </div>
          </div>

          <div class="field full custoField">
            <label for="custoHora">
              Custo da impressora por hora (R$/h)
              <span class="badge badge-custo">CUSTO</span>
            </label>
            <div class="input-with-btn">
              <input id="custoHora" type="number" min="0" step="0.01" value="2.00">
              <button type="button" id="btnCalcCusto" class="btn-icon" title="Calcular custo/hora">
                ğŸ§®
              </button>
            </div>
            <div class="hint">ğŸ’¡ NÃ£o sabe? Clique em ğŸ§® para calcular automaticamente</div>
          </div>

        </div>

        <!-- VENDA -->
        <div class="field full selling ganhoField">
          <h2>Venda <span class="badge badge-ganho">GANHO</span></h2>
          <div class="sell-grid">
            <div>
              <label for="precoFinal">PreÃ§o final que vou vender (R$)</label>
              <input id="precoFinal" type="number" min="0" step="0.01" value="0">
              <div id="alertaPreco" class="alerta" style="display:none;"></div>
            </div>
            <div class="profitBox ganhoBox">
              <div class="t">Lucro</div>
              <div class="v" id="outLucro">â€”</div>
            </div>
          </div>
        </div>

        <!-- AÃ§Ãµes -->
        <div class="field full actions">
          <button id="btnCalcular" class="btn primary" type="submit">
            ğŸ“Š Calcular
          </button>
          <button id="btnSalvarCalculo" class="btn" type="button">
            ğŸ’¾ Salvar no HistÃ³rico
          </button>
          <button id="btnRecomendado" class="btn" type="button">
            ğŸ”„ Reset
          </button>
          <button id="btnLimpar" class="btn" type="button">
            ğŸ—‘ï¸ Limpar
          </button>
        </div>

      </form>

      <!-- KPIs + GrÃ¡fico -->
      <div class="resultados-row">
        <div class="kpis">
          <div class="kpi custoBox">
            <div class="t">Custo Filamento</div>
            <div class="v" id="outCustoFilamento">â€”</div>
          </div>
          <div class="kpi custoBox">
            <div class="t">Custo MÃ¡quina</div>
            <div class="v" id="outCustoMaquina">â€”</div>
          </div>
          <div class="kpi custoBox">
            <div class="t">Custo Total</div>
            <div class="v" id="outCusto">â€”</div>
          </div>
          <div class="kpi ganhoBox">
            <div class="t">PreÃ§o Sugerido</div>
            <div class="v" id="outPreco">â€”</div>
          </div>
        </div>
        <div class="grafico-container">
          <canvas id="graficoPizza"></canvas>
        </div>
      </div>

    </div>

    <!-- ========== ABA: HISTÃ“RICO ========== -->
    <div class="tab-content" data-content="historico">
      <div class="historico-header">
        <h2>ğŸ“œ HistÃ³rico de CÃ¡lculos</h2>
        <button id="btnExportarCSV" class="btn">ğŸ“‘ Exportar CSV</button>
      </div>
      <div id="listaHistorico" class="lista-historico">
        <div class="empty-state">Nenhum cÃ¡lculo salvo ainda.</div>
      </div>
    </div>

    <!-- ========== ABA: COMPARAÃ‡ÃƒO ========== -->
    <div class="tab-content" data-content="comparacao">
      <h2>âš–ï¸ Comparar CenÃ¡rios</h2>
      <div class="comparacao-grid">
        <div class="cenario">
          <h3>CenÃ¡rio A</h3>
          <label>Margem (%):</label>
          <input id="margemA" type="number" min="0" max="100" value="30">
          <div class="resultado-cenario">
            <div class="label">PreÃ§o:</div>
            <div class="valor" id="precoA">â€”</div>
          </div>
          <div class="resultado-cenario">
            <div class="label">Lucro:</div>
            <div class="valor" id="lucroA">â€”</div>
          </div>
        </div>
        <div class="cenario">
          <h3>CenÃ¡rio B</h3>
          <label>Margem (%):</label>
          <input id="margemB" type="number" min="0" max="100" value="40">
          <div class="resultado-cenario">
            <div class="label">PreÃ§o:</div>
            <div class="valor" id="precoB">â€”</div>
          </div>
          <div class="resultado-cenario">
            <div class="label">Lucro:</div>
            <div class="valor" id="lucroB">â€”</div>
          </div>
        </div>
        <div class="cenario">
          <h3>CenÃ¡rio C</h3>
          <label>Margem (%):</label>
          <input id="margemC" type="number" min="0" max="100" value="50">
          <div class="resultado-cenario">
            <div class="label">PreÃ§o:</div>
            <div class="valor" id="precoC">â€”</div>
          </div>
          <div class="resultado-cenario">
            <div class="label">Lucro:</div>
            <div class="valor" id="lucroC">â€”</div>
          </div>
        </div>
      </div>
      <button id="btnCompararAgora" class="btn primary">ğŸ” Comparar Agora</button>
    </div>

    <!-- ========== ABA: MODO CLIENTE ========== -->
    <div class="tab-content" data-content="cliente">
      <div class="modo-cliente">
        <h2>ğŸ’¼ OrÃ§amento para Cliente</h2>
        <div class="cliente-info">
          <input id="nomeCliente" type="text" placeholder="Nome do cliente">
          <input id="nomeProjeto" type="text" placeholder="Nome do projeto">
        </div>
        <div class="orcamento-visual" id="orcamentoCliente">
          <div class="orcamento-item">
            <span>ğŸ“¦ Material (filamento):</span>
            <span id="clienteFilamento">â€”</span>
          </div>
          <div class="orcamento-item">
            <span>ğŸ–¨ï¸ ImpressÃ£o (mÃ¡quina):</span>
            <span id="clienteMaquina">â€”</span>
          </div>
          <div class="orcamento-item">
            <span>ğŸ‘¨â€ğŸ’¼ MÃ£o de obra:</span>
            <span id="clienteMaoObra">â€”</span>
          </div>
          <div class="orcamento-item total">
            <span><strong>ğŸ’° Total:</strong></span>
            <span id="clienteTotal">â€”</span>
          </div>
        </div>
        <button id="btnGerarOrcamento" class="btn primary">ğŸ“„ Gerar PDF OrÃ§amento</button>
      </div>
    </div>

  </div>
</div>

<!-- ========== MODAIS ========== -->

<!-- Modal: Calculadora de Custo/Hora -->
<div id="modalCalcCusto" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>ğŸ§® Calcular Custo por Hora</h3>
      <button class="close-btn" data-close="modalCalcCusto">&times;</button>
    </div>
    <div class="modal-body">
      <div class="field">
        <label for="consumoW">Consumo da impressora (W)</label>
        <input id="consumoW" type="number" value="200" min="0">
        <div class="hint">MÃ©dia: 150-300W</div>
      </div>
      <div class="field">
        <label for="precoKwh">PreÃ§o do kWh (R$)</label>
        <input id="precoKwh" type="number" value="0.80" step="0.01" min="0">
        <div class="hint">Veja na sua conta de luz</div>
      </div>
      <div class="field">
        <label for="depreciacaoHora">DepreciaÃ§Ã£o/hora (R$/h)</label>
        <input id="depreciacaoHora" type="number" value="1.00" step="0.01" min="0">
        <div class="hint">ManutenÃ§Ã£o + desgaste</div>
      </div>
      <div class="field">
        <label for="tempoMonitora">Seu tempo/hora (R$/h)</label>
        <input id="tempoMonitora" type="number" value="0.50" step="0.01" min="0">
        <div class="hint">Monitoramento + ajustes</div>
      </div>
      <div class="resultado-calc">
        <strong>Custo total/hora:</strong>
        <span id="custoCalculado">R$ 0,00</span>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn" data-close="modalCalcCusto">Cancelar</button>
      <button id="btnAplicarCusto" class="btn primary">âœ… Aplicar</button>
    </div>
  </div>
</div>

<!-- Modal: Salvar no HistÃ³rico -->
<div id="modalSalvarHistorico" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>ğŸ’¾ Salvar CÃ¡lculo</h3>
      <button class="close-btn" data-close="modalSalvarHistorico">&times;</button>
    </div>
    <div class="modal-body">
      <label for="nomeCalculo">Nome do cÃ¡lculo:</label>
      <input id="nomeCalculo" type="text" placeholder="Ex: Boneco Iron Man" maxlength="50">
    </div>
    <div class="modal-footer">
      <button class="btn" data-close="modalSalvarHistorico">Cancelar</button>
      <button id="btnConfirmarSalvar" class="btn primary">ğŸ’¾ Salvar</button>
    </div>
  </div>
</div>

<!-- Toast -->
<div id="toast" class="toast"></div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="script.js"></script>
</body>
</html>
